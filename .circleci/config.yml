version: 2
jobs:
  lint:
    docker:
      - image: circleci/node:10
    steps:
      - checkout
      - run:
          name: install
          command: npm ci
      - run:
          name: lint
          command: npm run lint
  nglatest:
    docker:
      - image: circleci/node:10-browsers
    steps:
      - checkout
      - run:
          name: install
          command: npm ci
      - run:
          name: build
          command: npm run build
      - run:
          name: test-unit
          command: npm run test:unit
      - run:
          name: webdriver
          command: npm run webdriver
      - run:
          name: test-e2e-demo
          command: npm run test:e2e:demo
      - run:
          name: test-e2e-interoperability
          command: npm run test:e2e:interoperability
      - run:
          name: test-ivy
          command: npm run test:ivy
  ng80:
    docker:
      - image: circleci/node:10-browsers
    steps:
      - checkout
      - run:
          name: install
          command: npm ci
      - run:
          name: build
          command: npm run build
      - run:
          name: install-80
          command: npm install typescript@3.4.1 rxjs@6.4.0 zone.js@0.9.1 @angular/common@8.0.0 @angular/compiler@8.0.0 @angular/core@8.0.0 @angular/platform-browser@8.0.0 @angular/platform-browser-dynamic@8.0.0 @angular/router@8.0.0 @angular/cli@8.0.1 @angular/compiler-cli@8.0.0 @angular-devkit/build-angular@0.800.1 @angular-devkit/build-ng-packagr@0.800.1
      - run:
          name: test-unit
          command: npm run test:unit
      - run:
          name: webdriver
          command: npm run webdriver
      - run:
          name: test-e2e-demo
          command: npm run test:e2e:demo
      - run:
          name: test-e2e-interoperability
          command: npm run test:e2e:interoperability
  ngnext:
    docker:
      - image: circleci/node:10-browsers
    steps:
      - checkout
      - run:
          name: install
          command: npm ci
      - run:
          name: build
          command: npm run build
      - run:
          name: install-next
          command: npm install @angular/common@next @angular/compiler@next @angular/core@next @angular/platform-browser@next @angular/platform-browser-dynamic@next @angular/router@next @angular/cli@next @angular/compiler-cli@next @angular-devkit/build-angular@next @angular-devkit/build-ng-packagr@next
      - run:
          name: test-unit
          command: npm run test:unit
      - run:
          name: webdriver
          command: npm run webdriver
      - run:
          name: test-e2e-demo
          command: npm run test:e2e:demo
      - run:
          name: test-e2e-interoperability
          command: npm run test:e2e:interoperability
      - run:
          name: test-ivy
          command: npm run test:ivy
workflows:
  version: 2
  test:
    jobs:
      - lint
      - nglatest
      - ng80
      - ngnext
